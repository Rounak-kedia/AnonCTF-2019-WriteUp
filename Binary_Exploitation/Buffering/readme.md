# AnonCTF_2019: Buffering ⏳

**Category:** Binary Exploitation
**Points:** 20

**Problem Statement:**

>Luffy was looking into a file which was overflowing with the information about the infamous "devil fruit".<BR>
To obtain it ,he has to find where the information is <b>leaking</b>.<BR>


<A href="https://drive.google.com/open?id=121OLA-1DZPAWORPY9QuD-Q94MhOPGeRw">Devil_fruit</A>

## Write-Up
The given file is a binary-executable file.<br>
Running it on any linux-system i.e. <b>./devil_fruit</b> will ask us to input something random into the program which will give us a fake flag mocking us as losers.<br>
<i>Fake flag :<b>anonCTF{Im_not_stupid_to_give_that_easily}</b></i>

<p> There are two options for digging into this challenge.<br>First being , reverse-engineer the file using a tool like ghidra and the second being the clue from the question title i.e. "Buffer Overflow".I'll go with buffer-overflow attack:</p>.

>run a command called <b>objdump</b> or use any disassembler to find the address of a suspicious-flag-containing function named <i>secretfunction</i><br>

Input random characters lets say 50 'A's .You will find the segmentation fault happening.Now to find where segmentation fault is happening:

> first , try writing a python program to input multiple A's and pipe run it with the file.<br>Then check with the <b>dmsg</b> command where seg-fault is happening<br>
>The address at which A will start overflowing into the secret function's address will return us the no. of times we need to input A.<br>

Now append the address of secretfunction into the python script along with no. of times you have to enter A(13 times) and pipe run with ./devil_fruit.<br>
This will call the secretfunction and output us the flag which is:<br>
<b>anonCTF{8UfF3r==c4n_bE-D@n63r0u$}</b>
